

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Sheet &mdash; phpReport 2.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Getting values" href="gettingValues.html" />
    <link rel="prev" title="Calculator" href="calculator.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> phpReport
          

          
          </a>

          
            
            
              <div class="version">
                2.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="actions.html">Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="prototype.html">Prototyping</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataInput.html">Data input</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataOutput.html">Data output</a></li>
<li class="toctree-l1"><a class="reference internal" href="group.html">Group changes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="aggregation.html">Aggregation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="collector.html">Collector</a></li>
<li class="toctree-l2"><a class="reference internal" href="collector.html#row-counter">Row counter</a></li>
<li class="toctree-l2"><a class="reference internal" href="collector.html#group-counter">Group counter</a></li>
<li class="toctree-l2"><a class="reference internal" href="calculator.html">Calculator</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Sheet</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fixedsheet-class">FixedSheet class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sheet-class">Sheet class</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gettingValues.html">Getting values</a></li>
<li class="toctree-l1"><a class="reference internal" href="sugar.html">Methods returning information</a></li>
<li class="toctree-l1"><a class="reference internal" href="methods.html">Overview of methods and properties</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">phpReport</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="aggregation.html">Aggregation</a> &raquo;</li>
        
      <li>Sheet</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/gpoehl/phpReport/blob/master//docs/sheet.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="sheet">
<h1>Sheet<a class="headerlink" href="#sheet" title="Permalink to this headline">¶</a></h1>
<p>Aggregate values in an tabular form like in a spreadsheet.</p>
<p>Sometimes a sheet can eliminate the need for declaring a group or a data dimension.
You can also aggregate the same value in different sheets so that results are
grouped by different keys.</p>
<p>The sheet() method instantiates a Sheet or a FixedSheet object. Both of them are
special variants of the collector object and will be assigned to the total
collector ($total).</p>
<p>For each column in a sheet a calculator object will be instantiated and linked
via the $items array property.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All calculator objects within a Sheet or FixedSheet object are of the
same type.</p>
</div>
<p>Group levels are like sheet rows and data keys like sheet colums.</p>
<dl class="method">
<dt>
<code class="sig-name descname">sheet</code><span class="sig-paren">(</span><em class="sig-param">string $name</em>, <em class="sig-param">$value</em>, <em class="sig-param">$headerAction = null</em>, <em class="sig-param">$footerAction = null</em>, <em class="sig-param">...$params</em><span class="sig-paren">)</span></dt>
<dd><p>Aggregate attributes in a sheet.</p>
<p>Sheet is a collection of calculators for a horizontal representation of a value.
Call this method once for each sheet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$name</strong> (<em>string</em>) – Unique name to reference the sheet object. The
reference will be hold in $this-&gt;total.</p></li>
<li><p><strong>$value</strong> (<em>mixed</em>) – <p>Source of the key and value to be aggregated.
Must be served in an array with only one entry were key is the array key and value
the value.</p>
<p>Key and attribute name are attribute names when data row is an object or
or when row is an array the element keys. It’s also possiblbe to use a
closure which returns an array [key =&gt; value].
False to just instantiate and reference the sheet. To execute the calculation
call the add() method of the sheet object. This is very useful when
getting the key or value to be calculated is complicated and / or you need
these data on the detail level.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Using the array_column function might declaring the latest data dimension
redundant.</p>
</div>
</p></li>
<li><p><strong>$typ</strong> (<em>int|null</em>) – The calculator type.
Typ is used to choose between a calculator class. Options are XS, REGULAR
and XL. Defaults to XS. Typ belongs to all sheet items.</p></li>
<li><p><strong>$fromKey</strong> (<em>mixed</em>) – To use a fixed sheet declare the first
calculator name. Pass an array when sheet names are not in an sequence.
Example: [‘young’, ‘mid-aged’, ‘old’l
Null for sheets where calculators are instantiated for each key value.</p></li>
<li><p><strong>$toKey</strong> (<em>mixed</em>) – The last calculator name for fixed sheet. FromKey
will be icremented until $toKey is reached.</p></li>
<li><p><strong>$maxLevel</strong> (<em>int|null</em>) – The group level at which the value will be
added. Defaults to the maximum level of the dimension. Might be less when
aggregated data are only needed on higher levels.</p></li>
<li><p><strong>$params</strong> (<em>mixed</em>) – Variadic parameters to be passed to callables declared
with value parameter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>$this which allows method call chaining.</p>
</dd>
</dl>
</dd></dl>

<div class="section" id="fixedsheet-class">
<h2>FixedSheet class<a class="headerlink" href="#fixedsheet-class" title="Permalink to this headline">¶</a></h2>
<p>FixedSheet classes are best used when you know which columns you need and want
them to be instantiated all at once. To do so pass an array of column names or
the starting and ending name to the sheet() method.
When starting name is a string make sure that the ending name can be reached
by incrementing the starting name.</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="nv">$rep</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Report</span> <span class="p">(</span><span class="nv">$this</span><span class="p">);</span>
<span class="c1">// Declare season names as columns</span>
<span class="nv">$rep</span><span class="o">-&gt;</span><span class="na">sheet</span> <span class="p">(</span><span class="s1">&#39;sales&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;regionID&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;amount&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;spring&#39;</span><span class="p">,</span> <span class="s1">&#39;summer&#39;</span> <span class="p">,</span><span class="s1">&#39;autumn&#39;</span><span class="p">,</span> <span class="s1">&#39;winter&#39;</span><span class="p">])</span>

<span class="c1">// Declare columns 1 to 12 (e.g. to represent month)</span>
<span class="nv">$rep</span><span class="o">-&gt;</span><span class="na">sheet</span> <span class="p">(</span><span class="s1">&#39;sales&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;regionID&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;amount&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1">// Declare columns a, b, c, d, e and f</span>
<span class="nv">$rep</span><span class="o">-&gt;</span><span class="na">sheet</span> <span class="p">(</span><span class="s1">&#39;sales&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;regionID&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;amount&#39;</span><span class="p">],</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>When you try to add a value to an not existing column an exception will be thrown.</p>
</div>
<div class="section" id="sheet-class">
<h2>Sheet class<a class="headerlink" href="#sheet-class" title="Permalink to this headline">¶</a></h2>
<p>Sheet classes don’t have a fixed number of columns. Columns will be instantiated
whenever a data row delivers a new column name.</p>
<p>If you need columns in a sorted order you should sort your data accordingly.
If this in not suitable ksort the $items property of the sheet object.</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="nv">$rep</span> <span class="o">=</span> <span class="p">(</span><span class="k">new</span> <span class="nx">Report</span> <span class="p">(</span><span class="nv">$this</span><span class="p">))</span>
<span class="o">-&gt;</span><span class="na">data</span><span class="p">(</span><span class="s1">&#39;array&#39;</span><span class="p">)</span>
<span class="o">-&gt;</span><span class="na">sheet</span> <span class="p">(</span><span class="s1">&#39;sales&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;regionID&#39;</span><span class="o">=&gt;</span> <span class="s1">&#39;amount&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="gettingValues.html" class="btn btn-neutral float-right" title="Getting values" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="calculator.html" class="btn btn-neutral float-left" title="Calculator" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Günter Pöhl

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>